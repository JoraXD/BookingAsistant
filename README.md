# BookingAssistant

Telegram-бот для интерактивного бронирования поездок. Пользователь вводит произвольный текст, бот извлекает параметры поездки через YandexGPT и уточняет недостающие данные.

Бот сам распознаёт даты в сообщении пользователя (например, «завтра» или «в субботу»), используя `dateparser`, и переводит их в формат `YYYY-MM-DD`. Если дата в тексте не найдена, используется значение из ответа YandexGPT.

Если выбран транспорт «автобус», после подтверждения бот формирует ссылку вида `https://atlasbus.ru/Маршруты/ГородA/ГородB?date=YYYY-MM-DD` и проверяет, что страница доступна. Если она не выдаёт ошибку 404, бот отправляет ссылку пользователю, иначе пишет, что рейсы не найдены.
Если выбран транспорт «самолёт», бот запрашивает данные у API Aviasales,
сообщает минимальную цену в формате «городA-городB-дата-цена» и
спрашивает, нужно ли бронировать. После подтверждения отправляет ссылку на поиск.

## Запуск

1. Создайте файл `.env` со следующими переменными:

```
TELEGRAM_BOT_TOKEN=your_telegram_token
YANDEX_IAM_TOKEN=your_yandex_iam_token
YANDEX_FOLDER_ID=your_folder_id
MANAGER_BOT_TOKEN=manager_bot_token
MANAGER_CHAT_ID=manager_chat_id
AVIASALES_TOKEN=your_aviasales_token
```

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

3. Запустите пользовательского бота:

```bash
python main.py
```

4. Запустите бота менеджера (при необходимости):
```bash
python manager_bot.py
```

## Команды

- `/start` — начать диалог
- `/cancel` — сбросить текущую сессию
- `/info` или `/help` — инструкция

## Формат результата

После подтверждения бот отправляет пользователю сообщение в формате JSON:
```json
{
  "message": "Отправили заявку менеджеру, скоро с вами свяжутся!"
}
```
Данные заявки при этом пересылаются в чат `MANAGER_CHAT_ID` через бота с токеном `MANAGER_BOT_TOKEN`.
